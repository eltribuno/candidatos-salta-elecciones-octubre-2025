<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Widget Elecciones Salta 2025 - Listas y Candidatos</title>
  <style>
    /* ====== PALETA PASTEL (clara) ====== */
    :root {
      --bg: #f5f7fb;       /* fondo pastel sutil */
      --card: #ffffff;     /* tarjetas blancas */
      --muted: #5f6368;    /* texto secundario */
      --text: #1f2937;     /* texto principal */
      --ring: rgba(0,0,0,.08);
      --chip: rgba(0,0,0,.04);
      --radius: 16px;
      --shadow: 0 8px 24px rgba(0,0,0,.08);
    }

    html, body { height: auto; min-height: 0; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, 'Segoe UI', Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', 'Apple Color Emoji', 'Segoe UI Emoji';
      color: var(--text);
      background: var(--bg);
    }

    #salta-elec-2025-widget * { box-sizing: border-box; }

    .sew-wrap {
      background: var(--bg);
      border-radius: var(--radius);
      padding: clamp(12px, 2vw, 20px);
      border: 1px solid var(--ring);
    }

    .sew-header { display: grid; grid-template-columns: 1fr auto; gap: 12px; align-items: center; margin-bottom: 14px; }
    .sew-title { font-weight: 700; font-size: clamp(18px, 1.8vw, 22px); }

    .sew-controls { display: flex; gap: 8px; flex-wrap: wrap; justify-content: flex-end; }

    .sew-tab {
      background: var(--chip);
      color: var(--text);
      padding: 10px 14px;
      border-radius: 999px;
      border: 1px solid var(--ring);
      cursor: pointer;
      font-weight: 600;
      font-size: 14px;
      transition: transform .1s ease, background .15s ease, border-color .15s ease;
      user-select: none;
    }
    .sew-tab[aria-pressed="true"] { background: rgba(0,0,0,0.08); border-color: rgba(0,0,0,0.15); }

    .sew-search { display: flex; align-items: center; gap: 8px; background: var(--chip); padding: 8px 12px; border-radius: 999px; border: 1px solid var(--ring); min-width: 220px; }
    .sew-search input { all: unset; width: 100%; color: var(--text); font-size: 14px; }

    .sew-grid { display: grid; grid-template-columns: repeat(1, minmax(0, 1fr)); gap: clamp(10px, 1.5vw, 16px); }
    @media (min-width: 560px) { .sew-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
    @media (min-width: 900px) { .sew-grid { grid-template-columns: repeat(3, minmax(0, 1fr)); } }

    .sew-card {
      background: var(--card);
      border: 1px solid var(--ring);
      border-radius: 18px;
      overflow: hidden;
      box-shadow: var(--shadow);
      display: grid;
      grid-template-rows: auto 1fr;
      position: relative;
    }

    .sew-banner { display: grid; grid-template-columns: 64px 1fr auto; align-items: center; gap: 12px; padding: 12px; border-bottom: 1px solid var(--ring); background: linear-gradient(to right, #eaf0ff, #f9fbff); }
    .sew-logo { width: 64px; height: 64px; border-radius: 12px; object-fit: cover; border: 1px solid var(--ring); background: #fff; }
    .sew-names { display: grid; gap: 4px; }
    .sew-party { font-weight: 800; font-size: 16px; }
    .sew-chip { justify-self: end; margin-left: auto; white-space: nowrap; font-size: 12px; font-weight: 700; padding: 6px 10px; border-radius: 999px; border: 1px solid var(--ring); background: var(--chip); }

    .sew-body { padding: 12px; }
    .sew-role { font-size: 12px; color: var(--muted); text-transform: uppercase; letter-spacing: .12em; margin-bottom: 6px; display: inline-block; }

    .sew-list { list-style: none; padding: 0; margin: 0; display: grid; gap: 6px; }
    .sew-item { display: grid; grid-template-columns: 1fr; gap: 4px; padding: 8px 10px; border-radius: 10px; background: #f4f6fb; border: 1px solid #e5eaf4; }

    .sew-cand { font-weight: 700; }
    .sew-sub { font-size: 12px; color: var(--muted); }

    .sew-colored::before { content: ""; position: absolute; inset: 0 0 0 0; border-left: 6px solid var(--accent, #4b5563); border-radius: 18px; pointer-events: none; }

    .sew-foot { margin-top: 10px; display: flex; gap: 10px; justify-content: space-between; align-items: center; color: var(--muted); font-size: 12px; }
    .sew-meta { opacity: .9; }
    .sew-btn-copy { background: var(--chip); color: var(--text); border: 1px solid var(--ring); padding: 6px 10px; border-radius: 8px; cursor: pointer; font-weight: 600; font-size: 12px; }
  </style>
</head>
<body>
  <div id="salta-elec-2025-widget" role="region" aria-label="Listas y candidatos de Salta 2025">
    <div class="sew-wrap">
      <header class="sew-header">
        <h2 class="sew-title">SALTA 2025 · LISTAS Y CANDIDATOS</h2>
        <div class="sew-controls">
          <button class="sew-tab" data-chamber="diputados" aria-pressed="true">Diputados</button>
          <button class="sew-tab" data-chamber="senadores" aria-pressed="false">Senadores</button>
          <label class="sew-search">
            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M21 21l-4.3-4.3M10.5 18a7.5 7.5 0 1 1 0-15a7.5 7.5 0 0 1 0 15z" stroke="currentColor" stroke-width="1.6"/></svg>
            <input id="sew-q" placeholder="Buscar frente o candidato…" aria-controls="sew-grid" />
          </label>
        </div>
      </header>

      <section id="sew-grid" class="sew-grid" aria-live="polite"></section>

      <footer class="sew-foot">
        <div class="sew-meta">Fuente: datos provistos por la redacción · Actualizado: 23/10/2025</div>
        <button id="sew-copy" class="sew-btn-copy" type="button">Copiar EMBED</button>
      </footer>
    </div>
  </div>

  <script>
    // =================== DATOS ===================
    const SEW_DATA = [
      { key:'frente_izquierda', nombre:'Frente de Izquierda y de Trabajadores - Unidad', foto:'https://uscdn.eltribuno.com/102025/1761253345062.jpg', color:'#d32f2f', diputados:['Andrea Villegas','Jesús Choque','Carmen Venencia'], senadores:['Claudio Del Pla','Daniela Planes'] },
      { key:'fuerza_patria', nombre:'Fuerza Patria', foto:'https://uscdn.eltribuno.com/102025/1761253345824.jpg', color:'#0e4bb1', diputados:['Emiliano Estrada','Mercedes Figueroa','Carlos Rodas'], senadores:['Juan Manuel Urtubey','Nora Giménez'] },
      { key:'lla', nombre:'La Libertad Avanza', foto:'https://uscdn.eltribuno.com/102025/1761253338359.jpg', color:'#7c3aed', diputados:['Gabriela Flores','Carlos Raúl Zapata','Paola Alexandra Mielñik'], senadores:['María Emilia Orozco','Gonzalo Guzmán Coraita'] },
      { key:'mas', nombre:'Movimiento al Socialismo', foto:'https://uscdn.eltribuno.com/102025/1761253344474.jpg', color:'#c62828', diputados:['Emilio Ulises Fernández Ortiz','Bárbara Sofía Marinaro','Cristian José Sanconte Cruz coroborar'], senadores:['Marcos Tognolini','Marcela Viviana López'] },
      { key:'pv', nombre:'Partido de la Victoria', foto:'https://uscdn.eltribuno.com/102025/1761253341906.jpg', color:'#ef4444', diputados:['Marcela  Jesús','Guido Giacosa','Blanca Chacón Dorr'], senadores:['Sergio “Oso” Leavy','Laura Cartuccia'] },
      { key:'renacer', nombre:'Partido Renacer', foto:'https://uscdn.eltribuno.com/102025/1761253343795.jpg', color:'#16a34a', diputados:['Nicolás Vedia','Luciana Belén Latorre','Pablo Agustín Muro Sanmillán'], senadores:['Francisco Martín Rivas Vila','Carina María Ángela Milano'] },
      { key:'po', nombre:'Política Obrera', foto:'https://uscdn.eltribuno.com/102025/1761253341217.jpg', color:'#b91c1c', diputados:['Julio Quintana','Georgia del Milagro Romero','Cristian Rafael Pereyra'], senadores:['Violeta Gil','Nahuel Gustavo López'] },
      { key:'pls', nombre:'Primero Los Salteños', foto:'https://uscdn.eltribuno.com/102025/1761253340653.jpg', color:'#0ea5e9', diputados:['Bernardo Biella','Oriana Névora','Juan Cruz Cura'], senadores:['Flavia Royón','Nacho Jarsún'] },
      { key:'ucr', nombre:'Unión Cívica Radical', foto:'https://uscdn.eltribuno.com/102025/1761253343282.jpg', color:'#dc2626', diputados:['Soledad Farfán','Renán Castellanos','Fabiana Beky'], senadores:['Natalio Iglesias','Graciela Morales'] }
    ];

    // =================== LÓGICA ===================
    (function initSEW(){
      const grid = document.getElementById('sew-grid');
      const tabs = Array.from(document.querySelectorAll('.sew-tab'));
      const input = document.getElementById('sew-q');
      const copyBtn = document.getElementById('sew-copy');

      let chamber = 'diputados';
      let query = '';

      function render(){
        grid.innerHTML = '';
        const q = query.trim().toLowerCase();
        const items = SEW_DATA.filter(p => {
          if (!q) return true;
          const hay = [p.nombre, ...p.diputados, ...p.senadores].join(' ').toLowerCase();
          return hay.includes(q);
        });

        if (!items.length){
          const empty = document.createElement('div');
          empty.style.opacity = .8;
          empty.textContent = 'Sin resultados para "' + query + '"';
          grid.appendChild(empty);
          return;
        }

        items.forEach(p => {
          const card = document.createElement('article');
          card.className = 'sew-card sew-colored';
          card.style.setProperty('--accent', p.color || '#4b5563');
          card.setAttribute('role','group');
          card.setAttribute('aria-label', p.nombre);

          card.innerHTML = `
            <div class="sew-banner">
              <img class="sew-logo" src="${p.foto}" alt="Logo/Foto del frente ${p.nombre}" loading="lazy" />
              <div class="sew-names">
                <div class="sew-party">${p.nombre}</div>
                <div class="sew-sub">${chamber === 'diputados' ? 'Lista de candidatos a Diputados' : 'Fórmula para Senadores'}</div>
              </div>
              <span class="sew-chip" style="border-color:${hexAlpha(p.color, .35)}; background:${hexAlpha(p.color, .12)}; color:${bestText(p.color)};">${chamber === 'diputados' ? 'Diputados' : 'Senadores'}</span>
            </div>
            <div class="sew-body">
              <span class="sew-role" aria-hidden="true">${chamber}</span>
              <ol class="sew-list" aria-label="Candidatos">
                ${ (chamber === 'diputados' ? p.diputados : p.senadores)
                    .map((c, i)=>`<li class="sew-item"><span class="sew-cand">${i+1}. ${c}</span></li>`)
                    .join('') }
              </ol>
            </div>
          `;

          grid.appendChild(card);
        });

        // Notificar altura (para iframes autoajustables)
        if (window.parent && window.parent !== window) {
          const h = document.documentElement.scrollHeight;
          window.parent.postMessage({ type:'sew-size', height:h }, '*');
        }
      }

      function setChamber(next){
        chamber = next;
        tabs.forEach(b => b.setAttribute('aria-pressed', String(b.dataset.chamber === chamber)));
        render();
      }

      input.addEventListener('input', (e)=>{ query = e.target.value; render(); });
      tabs.forEach(b => b.addEventListener('click', ()=> setChamber(b.dataset.chamber)));

      const ro = new ResizeObserver(()=>{
        if (window.parent && window.parent !== window) {
          const h = document.documentElement.scrollHeight;
          window.parent.postMessage({ type:'sew-size', height:h }, '*');
        }
      });
      ro.observe(document.documentElement);

      const copyBtnHandler = ()=>{
        const embed = getIframeEmbed();
        navigator.clipboard.writeText(embed)
          .then(()=>{ copyBtn.textContent = 'EMBED copiado'; setTimeout(()=> copyBtn.textContent = 'Copiar EMBED', 1600); })
          .catch(()=>{ alert('No se pudo copiar. Seleccione y copie manualmente.'); });
      };
      copyBtn.addEventListener('click', copyBtnHandler);

      render();
    })();

    // ===== Utilidades de color =====
    function hexAlpha(hex, alpha){
      if(!hex) return `rgba(75,85,99,${alpha})`;
      const c = hex.replace('#','');
      const bigint = parseInt(c.length === 3 ? c.split('').map(x=>x+x).join('') : c, 16);
      const r = (bigint >> 16) & 255, g = (bigint >> 8) & 255, b = bigint & 255;
      return `rgba(${r}, ${g}, ${b}, ${alpha})`;
    }
    function bestText(hex){
      if(!hex) return '#1f2937';
      const c = hex.replace('#','');
      const bigint = parseInt(c.length === 3 ? c.split('').map(x=>x+x).join('') : c, 16);
      const r = (bigint >> 16) & 255, g = (bigint >> 8) & 255, b = bigint & 255;
      const L = (0.2126*r + 0.7152*g + 0.0722*b)/255;
      return L > 0.6 ? '#1f2937' : '#ffffff';
    }

    // ===== EMBED ROBUSTO (iframe con srcdoc + auto-resize) =====
    function getIframeEmbed(){
      const html = document.documentElement.outerHTML
        .replace(/\n/g,'')
        .replace(/\s{2,}/g,' ');

      return `<!-- Contenedor del iframe -->\n<div id="sew-embed" style="width:100%;"><iframe title="Listas y candidatos - Salta 2025" loading="lazy" style="width:100%; border:0; display:block; overflow:hidden;" referrerpolicy="no-referrer-when-downgrade"></iframe></div>\n<script>(function(){var w=document.getElementById('sew-embed');if(!w){console.error('Falta #sew-embed');return;}var f=w.querySelector('iframe');f.srcdoc=${JSON.stringify(html)};function onMsg(e){try{if(!e || !e.data || e.data.type!=='sew-size') return;var h=parseInt(e.data.height||0,10);if(h>0){f.style.height=h+'px';}}catch(err){}}window.addEventListener('message',onMsg);})();<\/script>`;
    }
  </script>
</body>
</html>
